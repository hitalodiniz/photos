#!/usr/bin/env sh
# Nota: As linhas abaixo sÃ£o necessÃ¡rias para Husky v9
# O aviso de depreciaÃ§Ã£o Ã© apenas para versÃµes futuras (v10+)
. "$(dirname -- "$0")/_/husky.sh"

# ğŸ”’ PROTEÃ‡ÃƒO VIA TESTES UNITÃRIOS
# Este hook executa testes e build para garantir qualidade
# Arquivos crÃ­ticos sÃ£o protegidos por testes unitÃ¡rios especÃ­ficos

# Executa testes
echo "ğŸ§ª Executando testes..."
npm test
TEST_EXIT_CODE=$?

if [ $TEST_EXIT_CODE -ne 0 ]; then
  echo ""
  echo "âŒ Testes falharam! Commit cancelado."
  echo "âš ï¸  Por favor, corrija os testes antes de commitar."
  exit 1
fi

# Executa build
echo "ğŸ”¨ Executando build..."
npm run build
BUILD_EXIT_CODE=$?

if [ $BUILD_EXIT_CODE -ne 0 ]; then
  echo ""
  echo "âŒ Build falhou! Commit cancelado."
  echo "âš ï¸  Por favor, corrija os erros de build antes de commitar."
  exit 1
fi

echo ""
echo "âœ… Todos os checks passaram. Commit permitido."
exit 0
